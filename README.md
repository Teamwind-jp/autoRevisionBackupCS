# autoRevisionBackupCS
windows用の常駐型のツールソフトです。  
指定ファイルを履歴付きで定期バックアップして媒体の故障や編集ミスによる文章の消失防止を目的としています。  
私は、編集中の文章の必要な部分を気付かぬまま削除してしまいそのまま保存するミスをよくします。一日かけた文章を翌日開いたら前半部分が消えているとか。  
本ソフトで編集中の安心感が段違いになります。

Basic版も公開しています。コード比較できます。

# Requirement
.net framework4.8を指定しているので適宜変更してください。  
VS2022でビルドしています。

# Usage
1.drop backup fileのテキストボックスにエクスプローラーから対象ファイルをドラッグドロップします。  
　(過去に実行している場合は、ログから他の設定内容を自動で設定します)  
2.srop backup folderのテキストボックスにバックアップ先フォルダをドラッグドロップします。  
　可能ならば別の媒体を指定すると媒体故障のリスクを回避できます。  
3.Max Rev.に履歴数を設定します。  
　多いほど復旧できる可能性が高くなります。  
4.Intervalにバックアップ監視間隔を設定します。  
5.「Start」ボタンを押すとバックアップが開始されます。  
6.「Log」ボタンは、以前実行したファイルの一覧画面を表示します。  
　選択したファイルのバックアップ設定を読み込みます。  

# How It Works
1.バックアップするタイミングは、Intervalの間隔でファイルの更新日時を監視し前回確認した日時よりも新しい場合にバックアップを行います。そのため編集中のファイルは、こまめに上書き保存してください。  
2.Office系のファイルは、上書き保存しないと更新日時が変わらないので注意してください。自動回復保存を有効にしただけでは更新日は変わりません。  

# Tecnical Details
主なコードは、以下の通りです。  
1.常駐監視処理は、バックグラウンドワーカーを使用しています。  
2.デリゲート。  
3.ファイル・ディレクトリ操作。  
4.ドラッグドロップ。  
5.ログファイルの読み書き。  

# Note
バックアップ対象を複数指定にする。フォルダを対象にする。等の変更も本コードの流用で可能かと思います。  
現在の画面をサブ化してインターフェースを小型化すれば編集しながら稼働状況確認出来ると思います。  
対象ファイルの更新とバックアップ（コピー処理）のタイミングがバッティングしてしまうとコピーが失敗する可能性があります。また、バックアップ先行でバッティングした場合は、本来の処理に影響する可能性がありますので、注意してください。

# License
MIT license。著作権は、Teamwindです。  

# Note
バグがあるかもしれません。自己責任でご利用ください。また適宜コード変更してください。  
ご要望等がございましたらメール下さい。

